<!DOCTYPE html>
<html lang="en">
<head>
	<title>Shower Presentation Engine</title>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="shower/themes/ribbon/styles/screen-16x10.css">
</head>
<body class="shower list">
	<header class="caption">
		<h1>DevOps</h1>
		<p>Qu'est-ce qu'un DevOps et comment Ansible peut aider... </p>
	</header>
	<section class="slide">
		<h2 class="shout shrink">Introduction à Ansible</h2>
	</section>
	<section class="slide">
		<h2>Rôle</h2>
		<div>
			<div style="float:left;width:50%">
				<strong>Développeur</strong>
				<ul>
					<li>Produire un WAR applicatif</li>
					<li>Produire un <code>.egg</code></li>
					<li>Produire un RPM</li>
				</ul>
			</div>
			<div style="float:right;width:50%">
				<strong>Opérationnel</strong>
				<ul>
					<li>Déployer le WAR dans Tomcat</li>
					<li>Installer le <code>.egg</code> avec <code>pip</code></li>
					<li>Installer le RPM avec <code>yum</code></li>
				</ul>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Résponsabilité</h2>
		<pre>
			<code><mark>java.lang.OutOfMemoryError: Java heap space</mark></code>
			<code>    at java.nio.HeapIntBuffer.&lt;init&gt;(Unknown Source)</code>
			<code>    at java.nio.IntBuffer.allocate(Unknown Source)</code>
			<code>    ...</code>
		</pre>
		<div>
			<div style="float:left;width:50%">
				<strong>Développeur</strong>
				<p>Fuite mémoire</p>
			</div>
			<div style="float:right;width:50%">
				<strong>Opérationnel</strong>
				<p>Serveur pas assez puissant</p>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Résponsabilité</h2>
		<pre>
			<code><mark>java.io.IOException: There is not enough space on the disk</mark></code>
			<code>    at java.io.FileOutputStream.writeBytes(Native Method)</code>
			<code>    at java.io.FileOutputStream.write(Unknown Source)</code>
			<code>    ...</code>
		</pre>
		<div>
			<div style="float:left;width:50%">
				<strong>Développeur</strong>
				<p>Fichiers de log trop verbeux</p>
			</div>
			<div style="float:right;width:50%">
				<strong>Opérationnel</strong>
				<p>Disque-dur trop petit</p>
			</div>
		</div>
	</section>
	<section class="slide">
		<div style="text-align: center;">
			<img src="pictures/ping-pong.png" style="width:50%; height:50%; "  />
		</div>
	</section>
	<section class="slide">
		<h2>DevOps</h2>
		<div>
			<div style="float:left; width:50%;">
				<img src="pictures/devops.png" style="width:75%; height: 75%" />
				<p><strong>Développeur</strong> + <strong>Opérationnel</strong></p>
			</div>
			<div style="float:right;width:50%">
				<ul>
					<li>Est <em>un développeur</em></li>
					<li>Est sensibilité <em>aux problématiques opérationnelles</em></li>
					<li><em>Fluidifie</em> les mises en production</li>
				</ul>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Problématiques opérationnelles</h2>
		<div class="double">
			<ul>
				<li><em>Installation</em></li>
				<li>Maintenance</li>
				<li>Supervision</li>
				<li>Alerting</li>
				<li>Résilience</li>
				<li><em>Automatisation</em></li>
				<li>Disponibilité</li>
				<li>Etc.</li>
			</ul>
		</div>
	</section>
	<section class="slide">
		<h2>Installation</h2>
		<div>
			<div style="float:left; width:50%;">
				<p><strong>Provisionning</strong></p>
				<img src="pictures/berceau.jpg" style="width:50%; height:50%;" />
			</div>
			<div style="float:right;width:50%">
				<p><strong>Déploiement</strong></p>
				<img src="pictures/bébé.jpg" style="width:75%; height:75%;" />
			</div>
			<div class="clear: both"></div>
		</div>
	</section>
	<section class="slide">
		<h2>Automatisation</h2>
		<div>
			<div style="float:left; width:50%;">
				<p><strong>Développeur</strong></p>
				<ul>
					<li>Maven</li>
					<li>Nexus</li>
					<li>Make</li>
					<li>Gulp</li>
				</ul>
			</div>
			<div style="float:right;width:50%">
				<p><strong>Operationnel</strong></p>
				<ul>
					<li>Bash</li>
					<li>Chef</li>
					<li>Puppet</li>
					<li><em>Ansible</em></li>
				</ul>
				<p class="note">Infrastructure as Code</p>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Ansible</h2>
		<div>
			<div style="float:left; width:50%;">
				<ul>
					<li>Python</li>
					<li>SSH</li>
					<li>YAML</li>
					<li><em>Idempotence</em></li>
					<li><em>États finaux</em></li>
				</ul>
			</div>
			<div style="float:right;width:50%">
				<img src="pictures/ansible.png" style="height:75%;width:75%" />
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Concepts</h2>
		<div>
			<div style="float:left; width:33%;">
				<p><strong>Machines</strong></p>
				<ul>
					<li>Inventory</li>
					<li>Hosts</li>
				</ul>
			</div>
			<div style="float:left; width:33%;">
				<p><strong>Etats</strong></p>
				<ul>
					<li>Tasks</li>
					<li>Handlers</li>
					<li>Roles</li>
				</ul>
			</div>
			<div style="float:left; width:33%;">
				<p><strong>Glue</strong></p>
				<ul>
					<li>Templates</li>
					<li>Variables</li>
				</ul>
			</div>
		</div>
		<p style="text-align: center;" class="note">Et c'est tout !</p>
	</section>
	<section class="slide">
		<h2>Inventory</h2>
		<div>
			<div style="float:left; width:50%;">
				<p><strong>Recette</strong></p>
				<ul>
					<li><code>pan.starclay.fr</code></li>
					<li><code>daphnis.starclay.fr</code></li>
					<li><code>atlas.starclay.fr</code></li>
				</ul>
				<p style="text-align: left;" class="note">&frac12; production</p>
			</div>
			<div style="float:left; width:50%;">
				<p><strong>Production</strong></p>
				<ul>
					<li><code>metis.starclay.fr</code></li>
					<li><code>adrastee.starclay.fr</code></li>
					<li><code>amalthee.starclay.fr</code></li>
					<li><code>thebee.starclay.fr</code></li>
					<li><code>europe.starclay.fr</code></li>
				</ul>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Inventory</h2>
		<pre>
			<code>[storage]</code>
			<code>pan</code>
			<code>[site]</code>
			<code>daphis</code>
			<code>[reverse-proxy]</code>
			<code>atlas</code>
		</pre>
		<p style="text-align: left;" class="note"><code>recette.ini</code></p>
	</section>
	<section class="slide">
		<h2>Inventory</h2>
		<div style="float:left; width:50%;">
			<pre style="font-size:75%">
				<code>[storage]</code>
				<code>pan</code>
				<code>[site]</code>
				<code>daphis</code>
				<code>[reverse-proxy]</code>
				<code>atlas</code>
			</pre>
			<p style="text-align: left;" class="note"><code>recette.ini</code></p>
		</div>
		<div style="float:left; width:50%;">
			<pre style="font-size:75%">
				<code>[storage]</code>
				<code>metis</code>
				<code>adrastee</code>
				<code>[site]</code>
				<code>thebee</code>
				<code>amalthee</code>
				<code>[reverse-proxy]</code>
				<code>europe</code>
			</pre>
			<p style="text-align: left;" class="note"><code>production.ini</code></p>
		</div>
	</section>
	<section class="slide">
		<h2>Tasks</h2>
		<div>
			<div style="float:left; width:50%;">
				<ul>
					<li>Etat final</li>
					<li>Idempotence</li>
					<li>Module</li>
				</ul>
			</div>
			<div style="float:right;width:50%">
				<pre style="font-size:100%">
					<code>hosts: storage</code>
					<code>tasks: </code>
					<code>- name: install PostgreSQL</code>
					<code>  yum: </code>
					<code>    name="postgresql"</code>
					<code>    <mark>state=installed</mark></code>
				</pre>
				<p style="text-align: left;" class="note"><code>site.yml</code></p>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Tasks</h2>
		<p><strong>Modules de base</strong></p>
		<div class="double">
			<ul>
				<li>yum</li>
				<li>copy</li>
				<li>template</li>
				<li>lineinfile</li>
				<li>fetch</li>
				<li>unarchive</li>
				<li>service</li>
				<li>...</li>
			</ul>
		</div>
		<p style="text-align: left;" class="note"><a href="http://docs.ansible.com/ansible/list_of_all_modules.html">http://docs.ansible.com/ansible/list_of_all_modules.html</a></p>
	</section>
	<section class="slide">
		<h2>Tasks</h2>
		<p><strong>Modules avancés</strong></p>
		<div class="double">
			<ul>
				<li>docker_login</li>
				<li>lxc_container</li>
				<li>potgresql_user</li>
				<li>gitlab_release</li>
				<li>slack</li>
				<li>zfs</li>
				<li>proxmox</li>
				<li>...</li>
			</ul>
		</div>
	</section>
	<section class="slide">
		<h2>Handlers</h2>
		<div>
			<div style="float:left; width:50%;">
				<pre style="font-size:75%">
					<code>tasks: </code>
					<code>- name: configure NGINX</code>
					<code>  copy: </code>
					<code>    src="files/nginx.conf"</code>
					<code>    dest="/etc/nginx.conf"</code>
					<code>  <mark>notify: </mark></code>
					<code>  <mark>- restart NGINX</mark></code>
				</pre>
				<ul>
					<li>Invoqué uniquement si <em>l'état</em> a changé</li>
				</ul>
			</div>
			<div style="float:left; width:50%;">
				<pre style="font-size:75%">
					<code>handlers: </code>
					<code><mark>- name: restart NGINX</mark></code>
					<code><mark> service: name=nginx state=restarted</mark></code>
					<code>- name: alert team</code>
					<code> local_action: </code>
					<code>   module: slack</code>
					<code>   msg: "Something went wrong! "</code>
				</pre>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Roles</h2>
		<div>
			<div style="float:left; width:66%;">
				<pre style="font-size:100%">
					<code>hosts: storage</code>
					<code>roles:</code>
					<code>- "elastic-search"</code>
					<code>- { role: "postgresql", </code>
					<code>    postgresql_version: "9.2" }</code>
				</pre>
			</div>
			<div style="float:left; width:33%;">
				<ul>
					<li>Groupement de <em>tasks</em></li>
					<li>Versionnable</li>
					<li>ansible-galaxy</li>
				</ul>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Templates</h2>
		<div>
			<div style="float:left; width:50%;">
				<ul>
					<li>Jinja</li>
					<li>Variable</li>
					<li>Surcharge</li>
				</ul>
			</div>
			<div style="float:right; width:50%;">
				<img src="pictures/jinja2.png" style="" />
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Templates</h2>
		<div>
			<div>
				<pre style="font-size:75%">
					<code>hosts: role-balancer</code>
					<code>vars: </code>
					<code>  site_http_port: 80</code>
					<code>tasks:</code>
					<code>- name: configure HAProxy</code>
					<code>  template:</code>
					<code>    src="haproxy.cfg.j2"</code>
					<code>    dest="/etc/haproxy/haproxy.cfg"</code>
				</pre>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Templates</h2>
		<div>
			<div>
				<pre style="font-size:75%">
				  <code>frontend site</code>
				  <code>   balance roundrobin</code>
				  <code><mark>{% for host in groups["site"] %}</mark></code>
				  <code>   server {{ hostvars[host]["ansible_hostname"]}} \</code>
				  <code>     <mark>{{ host }}</mark>:{{ site_http_port }} check</code>
				  <code>{% endfor %}</code>
				</pre>
				<ul>
					<li>Boucles</li>
					<li>Formattage</li>
					<li>Etc.</li>
				</ul>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Utilisation</h2>
		<div>
			<div style="float:left; width:50%;">
				<p><strong>Playbook</strong></p>
				<pre style="font-size:75%">
				  <code>ansible-playbook \</code>
				  <code><mark>  -i "inventory.ini" \</mark></code>
				  <code><mark>  "site.yml" \</mark></code>
				  <code>  -e site_http_port=8080</code>
				</pre>
				<ul>
					<li>Roles</li>
					<li>Tâches</li>
				</ul>
			</div>
			<div style="float:left; width:50%;">
				<p><strong>One-shot</strong></p>
				<pre style="font-size:75%">
				  <code>ansible <mark>storage \</mark></code>
				  <code><mark>  -i "inventory.ini" \</mark></code>
				  <code><mark>  -m "shell" \<mark></code>
				  <code>  -a "sudo df -h"</code>
				</pre>
				<ul>
					<li>Usage direct des modules</li>
				</ul>
			</div>
		</div>
	</section>
	<section class="slide">
		<h2>Où aller à partir de là</h2>
		<ul>
			<li><a href="http://docs.ansible.com/">http://docs.ansible.com/</a></li>
			<li>Ansible Galaxy</li>
			<li><a href="https://github.com/ebiznext">https://github.com/ebiznext</a></li>
		</ul>
	</section>
	<section class="slide">
		<h2 class="shout shrink">Merci</h2>
	</section>
	<script src="shower/shower.min.js"></script>
</body>
</html>
